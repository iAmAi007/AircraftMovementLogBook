<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aircraft Table</title>
    <!-- Link the Web App Manifest -->
    <link rel="manifest" href="/manifest.json">
    <!-- Add theme color for PWA -->
    <meta name="theme-color" content="#2c5175">
    <!-- Add iOS support -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Your existing styles -->
    <style>
        @font-face {
            font-family: 'SF Pro Display';
            src: url('SFPRODISPLAY-REGULAR.TTF') format('truetype');
            font-weight: normal;
            letter-spacing: 1px;
            font-style: normal;
        }
        @font-face {
            font-family: 'SF Pro Display';
            src: url('SFProDisplay-Bold.ttf') format('truetype');
            font-weight: 700;
            letter-spacing: 1px;
            font-style: normal;
        }
        body {
            font-family: 'SF Pro Display';
            margin: 20px;
            overflow-x: auto;
            display: flex;
            justify-content: center; /* Center horizontally */
            min-height: 100vh; /* Ensure the body takes up the full viewport height */
            align-items: flex-start; /* Align content to the top (remove vertical centering) */
        }
        .table-container {
            display: flex;
            gap: 20px;
            width: max-content;
            margin: 0 auto; /* Center horizontally within the flex container */
        }
        table {
            border-collapse: collapse;
            table-layout: auto;
            min-width: 800px;
        }
        thead {
            border-top: 1px solid #2c5175;
            border-bottom: 1px solid #2c5175;
        }
        tbody {
            border-bottom: 1px solid #2c5175;
        }
        th {
            text-align: left;
            font-size: 16px;
            font-weight: 700;
            padding: 10px 5px;
            color: #2c5175;
            background-color: #FFFFFF;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        td {
            padding: 10px 5px;
            font-size: 16px;
            color: #2c5175;
            letter-spacing: 0.5px;
        }
        tr:nth-child(odd) {
            background-color: #EAF3FB;
        }
        tr:nth-child(even) {
            background-color: #FFFFFF;
        }
        th, td {
            border: none;
        }
        td[contenteditable="true"]:focus {
            outline: 2px solid #2c5175;
            background-color: #f0f8ff;
        }
        .slider {
            width: 100%;
            overflow-x: auto;
            margin-top: 20px;
        }
        .table-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .table-header h2 {
            font-size: 16px;
            font-weight: bold;
            color: #2c5175;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0;
        }
        .table-header .header-input {
            display: flex;
            align-items: center;
            gap: 10px; /* Adjust the gap between elements */
        }
        /* Add margin to the DAY dropdown */
        .table-header .header-input select {
            margin-right: 20px; /* Move the DAY dropdown to the left */
        }
        .table-header select,
        .table-header input[type="date"] {
            font-family: 'SF Pro Display', sans-serif; /* Use the same font as the rest of the app */
            font-size: 16px; /* Match the font size of the DAY dropdown */
            color: #2c5175; /* Match the text color */
            text-transform: uppercase; /* Match the text style */
            font-weight: bold; /* Match the font weight */
            border: none; /* Remove default border */
            background: transparent; /* Match the background */
            padding: 5px; /* Match the padding */
            cursor: pointer; /* Show pointer cursor */
        }
        .table-header select:focus,
        .table-header input[type="date"]:focus {
            outline: none;
        }
        .table-header select option[disabled] {
            color: #999;
        }
        .date-input-container {
            position: relative;
            display: inline-block;
        }
        .date-input-container input[type="date"] {
            opacity: 1; /* Make the input visible */
            position: relative; /* Change from absolute to relative */
            width: auto; /* Allow the input to take its natural width */
            height: auto; /* Allow the input to take its natural height */
            cursor: pointer;
        }
        .date-input-container .date-placeholder {
            display: none; /* Hide the placeholder since the input is now visible */
        }
    </style>
</head>
<body>
    <div class="slider">
        <div class="table-container">
            <!-- Left Table Section (INBOUND TFC) -->
            <div>
                <div class="table-header">
                    <h2>INBOUND TFC</h2>
                    <div class="header-input">
                        <!-- DAY Dropdown -->
                        <select id="day-inbound">
                            <option value="MON">MON</option>
                            <option value="TUE">TUE</option>
                            <option value="WED">WED</option>
                            <option value="THU">THU</option>
                            <option value="FRI">FRI</option>
                            <option value="SAT">SAT</option>
                            <option value="SUN">SUN</option>
                        </select>
                        <!-- DATE Picker -->
                        <div class="date-input-container">
                            <input type="date" id="date-inbound">
                            <!-- Remove the placeholder since the input is now visible -->
                        </div>
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>SVC</th>
                            <th>REG</th>
                            <th>TYPE</th>
                            <th>FROM</th>
                            <th>SKED</th>
                            <th>ATC ETA</th>
                            <th>PLN</th>
                            <th>EET</th>
                            <th>ETA EDZ</th>
                            <th>REMARKS</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Two rows for INBOUND TFC -->
                        <tr>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true"></td>
                        </tr>
                        <tr>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Right Table Section (OUTBOUND TFC) -->
            <div>
                <div class="table-header">
                    <h2>OUTBOUND TFC</h2>
                    <div class="header-input">
                        <!-- DAY Dropdown -->
                        <select id="day-outbound">
                            <option value="MON">MON</option>
                            <option value="TUE">TUE</option>
                            <option value="WED">WED</option>
                            <option value="THU">THU</option>
                            <option value="FRI">FRI</option>
                            <option value="SAT">SAT</option>
                            <option value="SUN">SUN</option>
                        </select>
                        <!-- DATE Picker -->
                        <div class="date-input-container">
                            <input type="date" id="date-outbound">
                            <!-- Remove the placeholder since the input is now visible -->
                        </div>
                    </div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>AIM</th>
                            <th>REG</th>
                            <th>TYPE</th>
                            <th>SVC</th>
                            <th>DEST</th>
                            <th>EOBT</th>
                            <th>ATD</th>
                            <th>POB</th>
                            <th>FR</th>
                            <th>ADDRESSEE’S</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Two rows for OUTBOUND TFC -->
                        <tr>
                            <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true"></td>
                        </tr>
                        <tr>
                            <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true" inputmode="numeric"></td>
                            <td contenteditable="true"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Function to enforce uppercase and ensure left-to-right typing
        function enforceUppercase(event) {
            const cell = event.target;
            const originalText = cell.innerText;
            const cursorPosition = window.getSelection().getRangeAt(0).startOffset;

            cell.innerText = originalText.toUpperCase();

            const range = document.createRange();
            const selection = window.getSelection();
            range.setStart(cell.childNodes[0], cursorPosition);
            range.collapse(true);
            selection.removeAllRanges();
            selection.addRange(range);
        }

        // Function to enforce numeric input
        function enforceNumericInput(event) {
            const cell = event.target;
            const originalText = cell.innerText;
            const cursorPosition = window.getSelection().getRangeAt(0).startOffset;

            const numericText = originalText.replace(/[^0-9]/g, '');
            cell.innerText = numericText;

            const range = document.createRange();
            const selection = window.getSelection();
            range.setStart(cell.childNodes[0], cursorPosition);
            range.collapse(true);
            selection.removeAllRanges();
            selection.addRange(range);
        }

        // Function to format date in all caps (e.g., 12 JAN 2025)
        function formatDateInCaps(date) {
            const months = ["JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC"];
            const day = date.getDate();
            const month = months[date.getMonth()];
            const year = date.getFullYear();
            return `${day} ${month} ${year}`;
        }

        // Function to get the day of the week from a date
        function getDayOfWeek(date) {
            const days = ["SUN", "MON", "TUE", "WED", "THU", "FRI", "SAT"];
            return days[date.getDay()];
        }

        // Function to synchronize DAY and DATE inputs
        function synchronizeInputs() {
            const dayInbound = document.getElementById('day-inbound');
            const dayOutbound = document.getElementById('day-outbound');
            const dateInbound = document.getElementById('date-inbound');
            const dateOutbound = document.getElementById('date-outbound');

            // Synchronize DAY inputs
            dayInbound.addEventListener('change', () => {
                dayOutbound.value = dayInbound.value;
            });
            dayOutbound.addEventListener('change', () => {
                dayInbound.value = dayOutbound.value;
            });

            // Synchronize DATE inputs and update DAY dropdown
            dateInbound.addEventListener('change', () => {
                const selectedDate = new Date(dateInbound.value);
                dateOutbound.value = dateInbound.value;
                const dayOfWeek = getDayOfWeek(selectedDate);
                dayInbound.value = dayOfWeek;
                dayOutbound.value = dayOfWeek;
            });
            dateOutbound.addEventListener('change', () => {
                const selectedDate = new Date(dateOutbound.value);
                dateInbound.value = dateOutbound.value;
                const dayOfWeek = getDayOfWeek(selectedDate);
                dayInbound.value = dayOfWeek;
                dayOutbound.value = dayOfWeek;
            });
        }

        // Function to generate AIM numbers
        function generateAIMNumbers(startValue) {
            const aimCells = document.querySelectorAll('.aim-cell');
            let currentValue = parseInt(startValue, 10);

            aimCells.forEach((cell, index) => {
                if (index === 0) return; // Skip the first cell
                currentValue = (currentValue % 999) + 1;
                cell.innerText = currentValue.toString().padStart(3, '0');
            });
        }

        // Function to set the current date and time
        function setCurrentDate() {
            const currentDate = new Date();
            const formattedDate = currentDate.toISOString().split('T')[0]; // YYYY-MM-DD format

            const dateInbound = document.getElementById('date-inbound');
            const dateOutbound = document.getElementById('date-outbound');

            dateInbound.value = formattedDate;
            dateOutbound.value = formattedDate;

            const dayInbound = document.getElementById('day-inbound');
            const dayOutbound = document.getElementById('day-outbound');

            const dayOfWeek = getDayOfWeek(currentDate);
            dayInbound.value = dayOfWeek;
            dayOutbound.value = dayOfWeek;
        }

        // Add event listeners to all editable cells
        document.querySelectorAll('td[contenteditable="true"]').forEach(cell => {
            cell.addEventListener('input', enforceUppercase);
        });

        // Add event listeners to numeric cells
        document.querySelectorAll('td[inputmode="numeric"]').forEach(cell => {
            cell.addEventListener('input', enforceNumericInput);
        });

        // Add event listener to the first AIM cell
        const firstAIMCell = document.querySelector('.aim-cell');
        firstAIMCell.addEventListener('input', (event) => {
            const startValue = event.target.innerText;
            if (/^\d{1,3}$/.test(startValue)) {
                generateAIMNumbers(startValue);
            }
        });

        // Set the current date and time on page load
        setCurrentDate();

        // Synchronize DAY and DATE inputs on page load
        synchronizeInputs();

        // Register the Service Worker
        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("/sw.js")
                .then((registration) => {
                    console.log("Service Worker registered with scope:", registration.scope);
                })
                .catch((error) => {
                    console.error("Service Worker registration failed:", error);
                });
        }
    </script>
</body>
</html>
