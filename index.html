<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aircraft Table</title>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#237cc0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        @font-face {
            font-family: 'SF Pro Display';
            src: url('SFPRODISPLAY-REGULAR.TTF') format('truetype');
            font-weight: normal;
            letter-spacing: 1px;
            font-style: normal;
        }
        @font-face {
            font-family: 'SF Pro Display';
            src: url('SFProDisplay-Bold.ttf') format('truetype');
            font-weight: 700;
            letter-spacing: 1px;
            font-style: normal;
        }

        body {
            font-family: 'SF Pro Display', sans-serif;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            overflow-x: auto;
        }

        .slider {
            width: 100%;
            max-width: 100%;
            overflow-x: auto;
            margin-top: 20px;
            display: flex;
            justify-content: center;
        }

        .table-container {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            width: max-content;
            align-items: stretch;
        }

        .table-wrapper {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: flex-start;
            position: relative;
        }

        table {
            border-collapse: collapse;
            table-layout: auto;
            min-width: 800px;
            width: 100%;
        }

        thead {
            border-top: 1px solid #237cc0;
            border-bottom: 1px solid #237cc0;
            letter-spacing: 1px;
        }

        tbody {
            border-bottom: 1px solid #237cc0;
        }

        th {
            text-align: left;
            font-size: 16px;
            font-weight: 700;
            padding: 10px 5px;
            color: #237cc0;
            background-color: #FFFFFF;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        td {
            padding: 10px 5px;
            font-size: 16px;
            color: #18557a;
            font-weight: 400;
            letter-spacing: 1px;
        }

        th, td {
            border: none;
        }

        tr:nth-child(odd) {
            background-color: #85d2f920;
        }

        tr:nth-child(even) {
            background-color: #FFFFFF;
        }

        td[contenteditable="true"]:focus {
            outline: 2px solid #237cc0;
            background-color: #f0f8ff;
        }

        .table-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
            letter-spacing: 1px;
            width: 100%;
            min-height: 40px;
        }

        .table-header h2 {
            font-size: 16px;
            font-weight: 700;
            color: #237cc0;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 0;
        }

        .table-header .header-input {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .table-header .header-input select {
            margin-right: 20px;
        }

        .table-header select,
        .table-header input[type="date"] {
            font-family: 'SF Pro Display', sans-serif;
            font-size: 16px;
            color: #237cc0;
            text-transform: uppercase;
            font-weight: 700;
            border: none;
            background: transparent;
            padding: 5px;
            cursor: pointer;
        }

        .table-header select:focus,
        .table-header input[type="date"]:focus {
            outline: none;
        }

        .date-input-container {
            position: relative;
            display: inline-block;
        }

        .date-input-container input[type="date"] {
            opacity: 1;
            position: relative;
            width: auto;
            height: auto;
            cursor: pointer;
        }

        .add-row-btn {
            font-size: 12px;
            color: #eb6028;
            background: none;
            border: none;
            cursor: pointer;
            margin-top: 10px;
            margin-bottom: 20px;
            padding: 0;
        }

        .add-row-btn:hover {
            color: #237cc0;
        }

        /* Options Window Styles */
        .edge-floating-menu {
            width: 220px;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(0, 0, 0, 0.08);
            font-family: 'SF Pro Display', sans-serif;
            font-size: 14px;
            letter-spacing: 0.2px;
            overflow: hidden;
            color: #18557a;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
            z-index: 1000;
        }

        .menu-item {
            padding: 8px 16px;
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .menu-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .menu-item .icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            opacity: 0.8;
            fill: #eb6028; /* Sets the SVG color */
        }

        .expand-icon {
            margin-left: auto;
            width: 16px;
            height: 16px;
            position: relative;
        }

        .expand-icon::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid #202124;
            opacity: 0.6;
            transition: transform 0.2s;
        }

        .expanded .expand-icon::enaryafter {
            transform: translate(-50%, -50%) rotate(90deg);
        }

        .separator {
            height: 0.1px;
            background-color: #70757a50;
            margin: 0;
            opacity: 0.6;
        }

        .filter-expanded {
            padding: 12px 12px 0;
            background: rgba(0, 0, 0, 0.03);
            border-top: 1px solid rgba(0, 0, 0, 0.08);
        }

        .filter-input {
            width: calc(100% - 16px);
            padding: 6px 8px;
            margin-bottom: 10px;
            border: 1px solid #237cc0 !important;
            border-radius: 4px;
            color: #18557a;
            font-family: inherit;
            text-transform: uppercase;
        }

        .filter-input::placeholder {
            text-transform: none;
        }

        .filter-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
            padding: 0 8px 8px;
        }

        .filter-count {
            font-size: 12px;
            color: #237cc0;
        }

        .filter-btn {
            padding: 4px 8px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-family: inherit;
            font-size: 13px;
            border-radius: 4px;
        }

        .filter-btn.clear {
            background-color: #f5f5f5;
            color: #237cc0;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-right: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            }

            .filter-btn.clear:hover {
            background-color: #e0e0e0;
            color: #18557a;
            }

        .filter-btn.apply {
            background: #0078d4;
            color: white;
        }

        .filter-btn.apply:hover {
            background: #106ebe;
        }

        @media print {
            @page {
                size: landscape;
                margin: 0.5in;
            }
            body {
                margin: 0;
                padding: 20px;
                display: flex;
                justify-content: center;
                align-items: flex-start;
                overflow: hidden;
            }
            .slider {
                width: 100%;
                max-width: 100%;
                overflow: hidden;
                margin-top: 20px;
                display: flex;
                justify-content: center;
            }
            .table-container {
                display: flex;
                gap: 20px;
                overflow-x: auto;
                width: max-content;
                align-items: stretch;
            }
            .table-wrapper {
                display: flex;
                flex-direction: column;
                align-items: flex-start;
                justify-content: flex-start;
                width: 50%;
                box-sizing: border-box;
            }
            table {
                border-collapse: collapse;
                table-layout: auto;
                min-width: 800px;
                width: 100%;
            }
            table, .table-wrapper {
                page-break-inside: avoid;
            }
            th, td {
                padding: 10px 5px;
                letter-spacing: 1px;
                font-size: 16px;
                color: #237cc0;
            }
            th {
                font-weight: 700;
                text-transform: uppercase;
                background-color: #FFFFFF;
            }
            td {
                font-weight: 400;
            }
            tr:nth-child(odd) {
                background-color: #EAF3FB;
            }
            tr:nth-child(even) {
                background-color: #FFFFFF;
            }
            thead {
                border-top: 1px solid #237cc0;
                border-bottom: 1px solid #237cc0;
            }
            tbody {
                border-bottom: 1px solid #237cc0;
            }
            .table-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 10px;
                letter-spacing: 1px;
                width: 100%;
                min-height: 40px;
            }
            .table-header h2 {
                font-size: 16px;
                font-weight: 700;
                color: #237cc0;
                text-transform: uppercase;
                margin: 0;
            }
            .add-row-btn, .edge-floating-menu {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="slider">
        <div class="table-container">
            <div class="table-wrapper inbound-table-wrapper">
                <div class="edge-floating-menu" id="optionsMenu">
                    <div class="menu-item" id="saveOption">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M17 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z"/>
                        </svg>
                        <span>Save</span>
                    </div>
                    <div class="separator"></div>
                    <div class="menu-item" id="filter-toggle">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
                        </svg>
                        <span>Filter</span>
                        <div class="expand-icon"></div>
                    </div>
                    <div class="filter-expanded" id="filter-expanded" style="display: none;">
                        <input type="text" class="filter-input" id="filterInput" placeholder="Type to filter...">
                        <div class="filter-buttons">
                            <span class="filter-count" id="filterCount">Filtered: 0</span>
                            <div>
                                <button class="filter-btn clear" id="clearFilter">Clear</button>
                                <button class="filter-btn apply" id="applyFilter">Apply</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div>
                    <div class="table-header">
                        <h2>INBOUND TFC</h2>
                        <div class="header-input">
                            <select id="day-inbound">
                                <option value="MON">MON</option>
                                <option value="TUE">TUE</option>
                                <option value="WED">WED</option>
                                <option value="THU">THU</option>
                                <option value="FRI">FRI</option>
                                <option value="SAT">SAT</option>
                                <option value="SUN">SUN</option>
                            </select>
                            <div class="date-input-container">
                                <input type="date" id="date-inbound">
                            </div>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>SVC</th>
                                <th>REG</th>
                                <th>TYPE</th>
                                <th>FROM</th>
                                <th>SKED</th>
                                <th>ATC ETA</th>
                                <th>PLN</th>
                                <th>EET</th>
                                <th>ETA EDZ</th>
                                <th>REMARKS</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="from-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true"></td>
                            </tr>

                        </tbody>
                    </table>
                    <button class="add-row-btn"><i class="fas fa-plus"></i></button>
                </div>
            </div>
            <div class="table-wrapper">
                <div>
                    <div class="table-header">
                        <h2>OUTBOUND TFC</h2>
                        <div class="header-input">
                            <select id="day-outbound">
                                <option value="MON">MON</option>
                                <option value="TUE">TUE</option>
                                <option value="WED">WED</option>
                                <option value="THU">THU</option>
                                <option value="FRI">FRI</option>
                                <option value="SAT">SAT</option>
                                <option value="SUN">SUN</option>
                            </select>
                            <div class="date-input-container">
                                <input type="date" id="date-outbound">
                            </div>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>AIM</th>
                                <th>REG</th>
                                <th>TYPE</th>
                                <th>SVC</th>
                                <th>DEST</th>
                                <th>EOBT</th>
                                <th>ATD</th>
                                <th>POB</th>
                                <th>FR</th>
                                <th>ADDRESSEE’S</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                            <tr>
                                <td contenteditable="true" inputmode="numeric" class="aim-cell"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true"></td>
                                <td contenteditable="true" class="dest-cell"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric"></td>
                                <td contenteditable="true" inputmode="numeric" class="pob-cell"></td>
                                <td contenteditable="true" inputmode="numeric" class="fr-cell"></td>
                                <td contenteditable="true"></td>
                            </tr>
                           
                        </tbody>
                    </table>
                    <button class="add-row-btn"><i class="fas fa-plus"></i></button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function isValidAIMInput(input) {
            return /^\d{1,3}$/.test(input) && parseInt(input, 10) >= 1 && parseInt(input, 10) <= 999;
        }

        function generateAIMNumbers(startValue) {
            const aimCells = document.querySelectorAll('.aim-cell:not(.header-cell)');
            let currentValue = parseInt(startValue, 10);
            if (isNaN(currentValue) || currentValue < 1 || currentValue > 999) return;
            aimCells.forEach((cell, index) => {
                if (index === 0) {
                    cell.innerText = currentValue.toString().padStart(3, '0');
                } else {
                    currentValue = (currentValue % 999) + 1;
                    cell.innerText = currentValue.toString().padStart(3, '0');
                }
            });
        }

        function handleAIMInput(event) {
            const cell = event.target;
            const input = cell.innerText;
            if (!isValidAIMInput(input)) {
                cell.classList.add('invalid');
            } else {
                cell.classList.remove('invalid');
            }
        }

        function autoFormatAIM(event) {
            const cell = event.target;
            const input = cell.innerText;
            if (isValidAIMInput(input)) {
                const numericValue = parseInt(input, 10);
                cell.innerText = numericValue.toString().padStart(3, '0');
                generateAIMNumbers(numericValue);
            } else {
                cell.classList.add('invalid');
            }
        }

        function handleTabKey(event) {
            if (event.key === 'Tab') {
                const cell = event.target;
                setTimeout(() => cell.blur(), 0);
            }
        }

        document.querySelectorAll('.aim-cell').forEach(cell => {
            cell.addEventListener('input', handleAIMInput);
            cell.addEventListener('blur', autoFormatAIM);
            cell.addEventListener('keydown', handleTabKey);
        });

        function enforceUppercase(event) {
            const cell = event.target;
            const originalText = cell.innerText;
            const cursorPosition = window.getSelection().getRangeAt(0).startOffset;
            cell.innerText = originalText.toUpperCase();
            const range = document.createRange();
            const selection = window.getSelection();
            range.setStart(cell.childNodes[0], cursorPosition);
            range.collapse(true);
            selection.removeAllRanges();
            selection.addRange(range);
        }

        function enforceNumericInput(event) {
            const cell = event.target;
            const originalText = cell.innerText;
            const cursorPosition = window.getSelection().getRangeAt(0).startOffset;
            const numericText = originalText.replace(/[^0-9]/g, '');
            cell.innerText = numericText;
            const range = document.createRange();
            const selection = window.getSelection();
            range.setStart(cell.childNodes[0], cursorPosition);
            range.collapse(true);
            selection.removeAllRanges();
            selection.addRange(range);
        }

        function enforceNumericInputForPOBAndFR(event) {
            const cell = event.target;
            const originalText = cell.innerText;
            const numericText = originalText.replace(/[^0-9]/g, '');
            cell.innerText = numericText;
            const range = document.createRange();
            const selection = window.getSelection();
            range.selectNodeContents(cell);
            range.collapse(false);
            selection.removeAllRanges();
            selection.addRange(range);
        }

        function validateFourAlphabets(event) {
            const cell = event.target;
            const input = cell.innerText.toUpperCase();
            if (input.length !== 4 || !/^[A-Z]{4}$/.test(input)) {
                cell.innerText = '';
            }
        }

        function validateFourNumeric(event) {
            const cell = event.target;
            if (cell.classList.contains('aim-cell') || cell.classList.contains('pob-cell') || cell.classList.contains('fr-cell')) return;
            const input = cell.innerText;
            if (input.length !== 4 || !/^\d{4}$/.test(input)) {
                cell.innerText = '';
                return;
            }
            const hours = parseInt(input.substring(0, 2), 10);
            const minutes = parseInt(input.substring(2, 4), 10);
            if (hours < 0 || hours > 23 || minutes < 0 || minutes > 59) {
                cell.innerText = '';
            }
        }

        function addRows() {
            const tables = document.querySelectorAll('.table-container > div');
            tables.forEach(tableContainer => {
                const addRowButton = tableContainer.querySelector('.add-row-btn');
                if (!addRowButton.dataset.listenerAdded) {
                    addRowButton.addEventListener('click', () => {
                        const table = tableContainer.querySelector('table');
                        const tbody = table.querySelector('tbody');
                        const aimCells = table.querySelectorAll('.aim-cell:not(.header-cell)');
                        let lastAIMValue = 0;

                        if (aimCells.length > 0) {
                            const lastAIMCell = aimCells[aimCells.length - 1];
                            lastAIMValue = parseInt(lastAIMCell.innerText, 10) || 0;
                        }

                        for (let i = 0; i < 5; i++) {
                            const newRow = tbody.insertRow();
                            for (let j = 0; j < tbody.rows[0].cells.length; j++) {
                                const newCell = newRow.insertCell();
                                newCell.contentEditable = true;
                                const isInboundTable = tableContainer.querySelector('h2').innerText === 'INBOUND TFC';
                                const isOutboundTable = tableContainer.querySelector('h2').innerText === 'OUTBOUND TFC';

                                if (tbody.rows[0].cells[j].classList.contains('aim-cell')) {
                                    newCell.classList.add('aim-cell');
                                    newCell.addEventListener('input', handleAIMInput);
                                    newCell.addEventListener('blur', autoFormatAIM);
                                    lastAIMValue = (lastAIMValue % 999) + 1;
                                    newCell.innerText = lastAIMValue.toString().padStart(3, '0');
                                } else if (tbody.rows[0].cells[j].classList.contains('pob-cell') || tbody.rows[0].cells[j].classList.contains('fr-cell')) {
                                    newCell.classList.add(tbody.rows[0].cells[j].classList.contains('pob-cell') ? 'pob-cell' : 'fr-cell');
                                    newCell.addEventListener('input', enforceNumericInputForPOBAndFR);
                                } else if (tbody.rows[0].cells[j].getAttribute('inputmode') === 'numeric') {
                                    newCell.setAttribute('inputmode', 'numeric');
                                    newCell.addEventListener('input', enforceNumericInput);
                                    if (isInboundTable && (j === 4 || j === 5 || j === 7 || j === 8)) {
                                        newCell.addEventListener('blur', validateFourNumeric);
                                    } else if (isOutboundTable && (j === 5 || j === 6)) {
                                        newCell.addEventListener('blur', validateFourNumeric);
                                    }
                                } else {
                                    newCell.addEventListener('input', enforceUppercase);
                                }
                                createFadedAutocomplete(newCell);
                            }
                        }
                    });
                    addRowButton.dataset.listenerAdded = 'true';
                }
            });
        }

        function setCurrentDate() {
            const currentDate = new Date();
            const formattedDate = currentDate.toISOString().split('T')[0];
            document.getElementById('date-inbound').value = formattedDate;
            document.getElementById('date-outbound').value = formattedDate;
            const dayOfWeek = getDayOfWeek(currentDate);
            document.getElementById('day-inbound').value = dayOfWeek;
            document.getElementById('day-outbound').value = dayOfWeek;
        }

        function getDayOfWeek(date) {
            const days = ["SUN", "MON", "TUE", "WED", "THU", "FRI", "SAT"];
            return days[date.getDay()];
        }

        function synchronizeInputs() {
            const dayInbound = document.getElementById('day-inbound');
            const dayOutbound = document.getElementById('day-outbound');
            const dateInbound = document.getElementById('date-inbound');
            const dateOutbound = document.getElementById('date-outbound');
            dayInbound.addEventListener('change', () => { dayOutbound.value = dayInbound.value; });
            dayOutbound.addEventListener('change', () => { dayInbound.value = dayOutbound.value; });
            dateInbound.addEventListener('change', () => {
                const selectedDate = new Date(dateInbound.value);
                dateOutbound.value = dateInbound.value;
                const dayOfWeek = getDayOfWeek(selectedDate);
                dayInbound.value = dayOfWeek;
                dayOutbound.value = dayOfWeek;
            });
            dateOutbound.addEventListener('change', () => {
                const selectedDate = new Date(dateOutbound.value);
                dateInbound.value = dateOutbound.value;
                const dayOfWeek = getDayOfWeek(selectedDate);
                dayInbound.value = dayOfWeek;
                dayOutbound.value = dayOfWeek;
            });
        }

        document.querySelectorAll('td[contenteditable="true"]').forEach(cell => {
            if (!cell.classList.contains('pob-cell') && !cell.classList.contains('fr-cell')) {
                cell.addEventListener('input', enforceUppercase);
            }
        });

        document.querySelectorAll('td[inputmode="numeric"]').forEach(cell => {
            if (!cell.classList.contains('pob-cell') && !cell.classList.contains('fr-cell')) {
                cell.addEventListener('input', enforceNumericInput);
            }
        });

        document.querySelectorAll('.pob-cell, .fr-cell').forEach(cell => {
            cell.addEventListener('input', enforceNumericInputForPOBAndFR);
        });

        document.querySelectorAll('.from-cell, .dest-cell').forEach(cell => {
            cell.addEventListener('blur', validateFourAlphabets);
        });

        document.querySelectorAll('td[inputmode="numeric"]').forEach(cell => {
            if (!cell.classList.contains('pob-cell') && !cell.classList.contains('fr-cell')) {
                cell.addEventListener('blur', validateFourNumeric);
            }
        });

        function saveHTML() {
            const docClone = document.documentElement.cloneNode(true);
            const addRowButtons = docClone.querySelectorAll('.add-row-btn');
            addRowButtons.forEach(button => button.remove());
            const optionsMenu = docClone.querySelector('#optionsMenu');
            if (optionsMenu) optionsMenu.style.display = 'none';

            const currentDate = new Date();
            const formattedDate = currentDate.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' }).replace(/ /g, '_').toUpperCase();
            const filename = `${formattedDate}_index.html`;
            const htmlContent = docClone.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            addRows();
        }

        function filterTables() {
    const filterValues = document.getElementById('filterInput').value.trim().toUpperCase().split(',').map(val => val.trim()).filter(val => val);
    const tables = document.querySelectorAll('.table-container table');
    let totalVisibleRows = 0;

    tables.forEach((table) => {
        const tbody = table.querySelector('tbody');
        const headers = Array.from(table.querySelector('thead tr').children).map(th => th.innerText);
        const rows = tbody.querySelectorAll('tr');

        rows.forEach(row => {
            const cells = Array.from(row.querySelectorAll('td'));
            const isEmptyRow = cells.every(cell => cell.innerText.trim() === '');
            const aimIndex = headers.indexOf('AIM');
            const hasOnlyAIM = aimIndex !== -1 && cells.length === headers.length && 
                cells.every((cell, idx) => idx === aimIndex ? /^\d{3}$/.test(cell.innerText.trim()) : cell.innerText.trim() === '');

            if (isEmptyRow || hasOnlyAIM) {
                row.style.display = 'none'; // Hide completely empty rows or rows with only AIM filled
                return;
            }

            let rowMatches = filterValues.length === 0;

            if (filterValues.length > 0) {
                const addresseeIndex = headers.indexOf('ADDRESSEE’S');
                const addresseeCell = addresseeIndex !== -1 ? cells[addresseeIndex] : null;
                const hasOtherFilledCells = cells.some(cell => cell !== (aimIndex !== -1 ? cells[aimIndex] : null) && cell.innerText.trim() !== '');

                if (filterValues.includes('DEP/HTDA')) {
                    const addresseeText = addresseeCell ? addresseeCell.innerText.toUpperCase() : '';
                    rowMatches = (addresseeText === 'DEP/HTDA') || (hasOtherFilledCells && addresseeText !== 'DEP/HTDA' && !addresseeText.startsWith('DEP/'));
                } else {
                    rowMatches = cells.some(cell => {
                        const cellText = cell.innerText.toUpperCase();
                        return filterValues.some(val => cellText.includes(val));
                    });
                }
            }

            row.style.display = rowMatches ? '' : 'none';
            if (rowMatches) totalVisibleRows++;
        });
    });

    document.getElementById('filterCount').innerText = `Filtered: ${totalVisibleRows}`;
    console.log(`Filtered: ${totalVisibleRows}`);
}

function clearFilter() {
    document.getElementById('filterInput').value = '';
    const tables = document.querySelectorAll('.table-container table');
    let totalVisibleRows = 0;

    tables.forEach(table => {
        const tbody = table.querySelector('tbody');
        const rows = tbody.querySelectorAll('tr');

        rows.forEach(row => {
            row.style.display = ''; // Show all rows, including empty ones and AIM-only rows
            totalVisibleRows++;
        });
    });

    document.getElementById('filterCount').innerText = `Filtered: ${totalVisibleRows}`;
    console.log(`Filtered: ${totalVisibleRows}`);
}

const optionsMenu = document.getElementById('optionsMenu');
const filterToggle = document.getElementById('filter-toggle');
const filterExpanded = document.getElementById('filter-expanded');
const saveOption = document.getElementById('saveOption');
const applyFilter = document.getElementById('applyFilter');
const clearFilterBtn = document.getElementById('clearFilter');
const filterInput = document.getElementById('filterInput');

document.addEventListener('keydown', (e) => {
    if (e.shiftKey && e.key === 'o') {
        e.preventDefault();
        optionsMenu.style.display = optionsMenu.style.display === 'block' ? 'none' : 'block';
        if (optionsMenu.style.display === 'block') filterInput.focus();
    } else if (e.key === 'Escape' && optionsMenu.style.display === 'block') { // Add this block
        e.preventDefault();
        optionsMenu.style.display = 'none';
        filterExpanded.style.display = 'none';
        filterToggle.classList.remove('expanded');
    } // End of added block
});

document.addEventListener('click', (e) => {
    if (!e.target.closest('.edge-floating-menu') && optionsMenu.style.display === 'block') {
        optionsMenu.style.display = 'none';
        filterExpanded.style.display = 'none';
        filterToggle.classList.remove('expanded');
    }
});

saveOption.addEventListener('click', () => {
    saveHTML();
    optionsMenu.style.display = 'none';
});

filterToggle.addEventListener('click', () => {
    const isExpanded = filterExpanded.style.display !== 'none';
    filterExpanded.style.display = isExpanded ? 'none' : 'block';
    filterToggle.classList.toggle('expanded', !isExpanded);
    if (!isExpanded) filterInput.focus();
});

applyFilter.addEventListener('click', () => {
    filterTables();
});

clearFilterBtn.addEventListener('click', () => {
    clearFilter();
    filterExpanded.style.display = 'none';
    filterToggle.classList.remove('expanded');
});

filterInput.addEventListener('keypress', (event) => {
    if (event.key === 'Enter') {
        filterTables();
    }
});

filterInput.addEventListener('input', (e) => {
    e.target.value = e.target.value.toUpperCase();
});

        const predefinedData = {
            SVC: ["ATC405", "ATC401", "01", "02","03","04","05","06","07","ZANZ01","ZANZ02","ZANZ03","TANZ01","TANZ02","TANZ03","TANZ04","08","AUK900","JW9805","JW9807","FLZ103","FLZ105","FLZ201","FLZ202","FLZ306","FLZ304","FLZ303","CSV121","CSV122","CSV131","CSV124","CSV123","CSV134","CSV202","CSV207","CSV261","CSV999","CSV998","ATC111", "ATC201", "ATC113", "ATC109", "ATC117", "ATC157", "ATC133", "ATC219", 
                "ATC209", "ATC215", "ATC213", "ATC137", "ATC119", "ATC107", "ATC203", "ATC125", "ATC103", "KQA488", 
                "THY603", "ETh827", "KQA482", "QTR1499", "ETH805", "AZB504", "LAM460", "AZW438", "QTR1476", "UAE725", 
                "LNK032", "KQA484", "OMA705", "RWD442", "FDB1687", "UGD320", "ETH803", "KQA486", "MWI042", "KLM571",
                "ATC110/1", "ATC200", "ATC112/3", "ATC108/9", "ATC116/7", "ATC157", "ATC132/3", "ATC218/9", "ATC208", "ATC214/5", "ATC213", "ATC136/7", "ATC118/9", "ATC156", "ATC106/7", "ATC202", "ATC404", "ATC400", "АТС124/5", "ATC102/3", "PRF717/8", "PRF400/1", "PRF713/2", "PRF420/1", "PRF416/7", "PRF642", "PRF612/3", "PRF422/3", "PRF721/0"],
                REG: ["5HKKC", "5HCGZ", "5HMXY", "5HAAA", "5HAAC", "5HAAE", "5HAAF", "5HAAG", "5HFLS", "5HFOX", "5HFZA", "5HGAS", "5HGEN", "5HGUS", "5HHEL", "5HIHN", "5HIKA", "5HIKI", "5HJAM", "5HAAU", "5HJOE", "5HAAJ", "5HAAK", "5HAAL", "5HAAN", "5HAAH", "5HAAP", "5HAAQ", "5HABC", "5HAIR", "5HAJK", "5HALO", "5HAMH", "5HAMI", "5HARD", "5HATP", "5HBAT", "5HBEE", "5HBIG", "5HBTZ", "5HBYO", "5HCCT", "5HCFA", "5HCPT", "5HCTJ", "5HDJS", "5HDTS", "5HEWA", "5HEXP", "5HFAR", "5HMYM", "5HZRP", "5HZOE", "5HKEG", "5HKJS", "5HZOG", "5HLEO", "5HLUV", "5HZAI", "5HYES", "5HMAD", "5HMEA", "5HMEB", "5HMEC", "5HMED", "5HMEE", "5HMEF", "5HMEK", "5HMFH", "5HWKF", "5HMIK", "5HMPK", "5HTZC", "5HTWF", "5HTPK", "5HONE","5HONF","JW9805","JW9807", "5HMSO", "5HTPC", "5HTGF", "5HTEC", "5HTCJ", "5HTCH", "5HKIH", "5HTCF", "5HTCP", "5HTCR", "5HTCI", "5HTCE", "5HTCK", "5HTCD", "5HTCB", "5HTCO", "5HTCM", "5HTAQ", "5HTAM", "5HSTJ", "5HSPC", "5HMWA", "5HSPA", "5HSGR", "5HMXG", "5HPWG", "5HPWE", "5HPWD", "5HPWC", "5HPWB", "5HMWF", "5HPOP", "5HPOA", "5HOIL", "5HMZU", "5HMZT", "5HMZD", "5HMZC", "5HMYK", "5HMYJ", "5HMYI", "5HMYH", "5HMYG", "5HTCL", "5HLCL", "5HELI", "5HLPD", "5HMEI", "5HLAB", "5HMYO", "5HMYP", "5HMYR", "5HMYQ", "5HMYN", "5HAAV", "5HMYS", "5HMHN", "5HUNT", "5HNIT", "5HNIA", "5HSPD", "5HOYO", "5HTFM", "5HSPE", "5HMEM", "5HMEH", "5HMEL", "5HTFB", "5HTFA", "5HAAX", "5HTCQ", "5HVAN", "5HMZE", "5HFLA", "5HFLB", "5HMYT", "5HTFG", "5HBLN", "5HHAD", "5HNAR", "5HKMA", "5HLUA", "5HMEP", "5HMEO", "5HSRA", "5HMYY", "5HPTJ", "5HMYU", "5HGEO", "5HMZR", "5HAZH", "5HULR", "5HIGH", "5HMEN", "5HMEJ", "5HLVV", "5HUSU", "5HCDL", "5HBIL", "TC", "ET", "A7", "C9", "Z", "A6", "ZS", "A4O", "9XR", "A6", "5Y", "PH", "5X"],
                TYPE: ["B39M", "B788", "BCS3", "DH8D", "E145","GA7C", "EC25","B737", "E120", "BE20","A330", "CRJ9", "E145", "B773", 
                "E190", "DH8D", "B38M", "AT45", "B763", "B77W", "PC12", "DH8A", "DH8B", "C172", "C206", "B789", "AT75", "C208", "F406", "F50", "AS32"],
            AIRPORTS: ["ZGGG","FLKK","FQPB","HKMO","HKKI","HKNW","FZQA","FZAA","OMAA","OMDW","OOMS","FWKI","OMDB", "VABB", "HTMW", "HKJK", "HTIR", "HTDO", "HTDA", "HTGW", "HTZA", "HTSO", "HTKA", 
                "FAOR", "HTKJ", "FZQA", "LTFM", "HAAB", "PQPB", "FVRG", "OTHH", "HRYR", "HUEN", 
                "FWCL", "FLSK", "HTMT", "OOMS", "HTAR", "EHAM", "HTAI", "HTAL", "HTAR", "HTAS", "HTBA", "HTBB", "HTBE", "HTBF", "HTBG", "HTBH", "HTBJ", "HTBM", "HTBN", "HTBO", "HTBS", "HTBT", "HTBU", "HTBV", "HTBX", "HTBY", "HTCF", "HTCH", "HTCM", "HTCV", "HTDA", "HTDB", "HTDG", "HTDK", "HTDN", "HTDO", "HTDU", "HTDY", "HTEB", "HTEE", "HTEJ", "HTEN", "HTEQ", "HTER", "HTES", "HTEY", "HTFE", "HTFI", "HTFR", "HTGA", "HTGE", "HTGL", "HTGM", "HTGO", "HTGP", "HTGR", "HTGS", "HTGT", "HTGU", "HTGV", "HTGW", "HTGZ", "HTHB", "HTHG", "HTHI", "HTHM", "HTHR", "HTHS", "HTHY", "HTIA", "HTIF", "HTIH", "HTIK", "HTIL", "HTIR", "HTIW", "HTIY", "HTJN", "HTJO", "HTJR", "HTKA", "HTKB", "HTKC", "HTKD", "HTKE", "HTKF", "HTKG", "HTKH", "HTKI", "HTKJ", "HTKL", "HTKM", "HTKN", "HTKO", "HTKP", "HTKR", "HTKS", "HTKT", "HTKU", "HTKX", "HTLA", "HTLB", "HTLD", "HTLE", "HTLI", "HTLJ", "HTLK", "HTLL", "HTLM", "HTLN", "HTLO", "HTLP", "HTLR", "HTLS", "HTLT", "HTLU", "HTLV", "HTLW", "HTLY", "HTMA", "HTMD", "HTME", "HTMF", "HTMG", "HTMH", "HTMI", "HTMJ", "HTMK", "HTML", "HTMM", "HTMN", "HTMO", "HTMP", "HTMR", "HTMS", "HTMT", "HTMU", "HTMV", "HTMW", "HTMX", "HTMY", "HTNA", "HTNB", "HTND", "HTNF", "HTNG", "HTNH", "HTNJ", "HTNK", "HTNM", "HTNN", "HTNO", "HTNR", "HTNW", "HTNY", "HTNZ", "HTOM", "HTON", "HTOP", "HTOR", "HTOZ", "HTPD", "HTPE", "HTPP", "HTPT", "HTPW", "HTRA", "HTRB", "HTRE", "HTRG", "HTRL", "HTRN", "HTRS", "HTRU", "HTRX", "HTRZ", "HTSA", "HTSB", "HTSD", "HTSE", "HTSG", "HTSH", "HTSI", "HTSJ", "HTSK", "HTSL", "HTSM", "HTSN", "HTSO", "HTSS", "HTST", "HTSU", "HTSW", "HTSY", "HTTA", "HTTB", "HTTC", "HTTE", "HTTF", "HTTG", "HTTJ", "HTTL", "HTTN", "HTTO", "HTTR", "HTTS", "HTTU", "HTTV", "HTTX", "HTTY", "HTTZ", "HTUC", "HTUF", "HTUG", "HTUK", "HTUN", "HTUO", "HTUP", "HTUR", "HTUS", "HTUT", "HTUU", "HTUV", "HTUW", "HTUZ", "HTVR", "HTWA", "HTWB", "HTWH", "HTWI", "HTWK", "HTWS", "HTYA", "HTYE", "HTYO", "HTYW", "HTYY", "HTZA", "HTZI", "HTZW"],
            'ADDRESSEE’S': ["DEP/HTAI", "DEP/HTAL", "DEP/HTAR", "DEP/HTAS", "DEP/HTBA", "DEP/HTBB", "DEP/HTBE", "DEP/HTBF", "DEP/HTBG", "DEP/HTBH", "DEP/HTBJ", "DEP/HTBM", "DEP/HTBN", "DEP/HTBO", "DEP/HTBS", "DEP/HTBT", "DEP/HTBU", "DEP/HTBV", "DEP/HTBX", "DEP/HTBY", "DEP/HTCF", "DEP/HTCH", "DEP/HTCM", "DEP/HTCV", "DEP/HTDA", "DEP/HTDB", "DEP/HTDG", "DEP/HTDK", "DEP/HTDN", "DEP/HTDO", "DEP/HTDU", "DEP/HTDY", "DEP/HTEB", "DEP/HTEE", "DEP/HTEJ", "DEP/HTEN", "DEP/HTEQ", "DEP/HTER", "DEP/HTES", "DEP/HTEY", "DEP/HTFE", "DEP/HTFI", "DEP/HTFR", "DEP/HTGA", "DEP/HTGE", "DEP/HTGL", "DEP/HTGM", "DEP/HTGO", "DEP/HTGP", "DEP/HTGR", "DEP/HTGS", "DEP/HTGT", "DEP/HTGU", "DEP/HTGV", "DEP/HTGW", "DEP/HTGZ", "DEP/HTHB", "DEP/HTHG", "DEP/HTHI", "DEP/HTHM", "DEP/HTHR", "DEP/HTHS", "DEP/HTHY", "DEP/HTIA", "DEP/HTIF", "DEP/HTIH", "DEP/HTIK", "DEP/HTIL", "DEP/HTIR", "DEP/HTIW", "DEP/HTIY", "DEP/HTJN", "DEP/HTJO", "DEP/HTJR", "DEP/HTKA", "DEP/HTKB", "DEP/HTKC", "DEP/HTKD", "DEP/HTKE", "DEP/HTKF", "DEP/HTKG", "DEP/HTKH", "DEP/HTKI", "DEP/HTKJ", "DEP/HTKL", "DEP/HTKM", "DEP/HTKN", "DEP/HTKO", "DEP/HTKP", "DEP/HTKR", "DEP/HTKS", "DEP/HTKT", "DEP/HTKU", "DEP/HTKX", "DEP/HTLA", "DEP/HTLB", "DEP/HTLD", "DEP/HTLE", "DEP/HTLI", "DEP/HTLJ", "DEP/HTLK", "DEP/HTLL", "DEP/HTLM", "DEP/HTLN", "DEP/HTLO", "DEP/HTLP", "DEP/HTLR", "DEP/HTLS", "DEP/HTLT", "DEP/HTLU", "DEP/HTLV", "DEP/HTLW", "DEP/HTLY", "DEP/HTMA", "DEP/HTMD", "DEP/HTME", "DEP/HTMF", "DEP/HTMG", "DEP/HTMH", "DEP/HTMI", "DEP/HTMJ", "DEP/HTMK", "DEP/HTML", "DEP/HTMM", "DEP/HTMN", "DEP/HTMO", "DEP/HTMP", "DEP/HTMR", "DEP/HTMS", "DEP/HTMT", "DEP/HTMU", "DEP/HTMV", "DEP/HTMW", "DEP/HTMX", "DEP/HTMY", "DEP/HTNA", "DEP/HTNB", "DEP/HTND", "DEP/HTNF", "DEP/HTNG", "DEP/HTNH", "DEP/HTNJ", "DEP/HTNK", "DEP/HTNM", "DEP/HTNN", "DEP/HTNO", "DEP/HTNR", "DEP/HTNW", "DEP/HTNY", "DEP/HTNZ", "DEP/HTOM", "DEP/HTON", "DEP/HTOP", "DEP/HTOR", "DEP/HTOZ", "DEP/HTPD", "DEP/HTPE", "DEP/HTPP", "DEP/HTPT", "DEP/HTPW", "DEP/HTRA", "DEP/HTRB", "DEP/HTRE", "DEP/HTRG", "DEP/HTRL", "DEP/HTRN", "DEP/HTRS", "DEP/HTRU", "DEP/HTRX", "DEP/HTRZ", "DEP/HTSA", "DEP/HTSB", "DEP/HTSD", "DEP/HTSE", "DEP/HTSG", "DEP/HTSH", "DEP/HTSI", "DEP/HTSJ", "DEP/HTSK", "DEP/HTSL", "DEP/HTSM", "DEP/HTSN", "DEP/HTSO", "DEP/HTSS", "DEP/HTST", "DEP/HTSU", "DEP/HTSW", "DEP/HTSY", "DEP/HTTA", "DEP/HTTB", "DEP/HTTC", "DEP/HTTE", "DEP/HTTF", "DEP/HTTG", "DEP/HTTJ", "DEP/HTTL", "DEP/HTTN", "DEP/HTTO", "DEP/HTTR", "DEP/HTTS", "DEP/HTTU", "DEP/HTTV", "DEP/HTTX", "DEP/HTTY", "DEP/HTTZ", "DEP/HTUC", "DEP/HTUF", "DEP/HTUG", "DEP/HTUK", "DEP/HTUN", "DEP/HTUO", "DEP/HTUP", "DEP/HTUR", "DEP/HTUS", "DEP/HTUT", "DEP/HTUU", "DEP/HTUV", "DEP/HTUW", "DEP/HTUZ", "DEP/HTVR", "DEP/HTWA", "DEP/HTWB", "DEP/HTWH", "DEP/HTWI", "DEP/HTWK", "DEP/HTWS", "DEP/HTYA", "DEP/HTYE", "DEP/HTYO", "DEP/HTYW", "DEP/HTYY", "DEP/HTZA", "DEP/HTZI", "DEP/HTZW"]
        };
        predefinedData.FROM = predefinedData.AIRPORTS;
        predefinedData.DEST = predefinedData.AIRPORTS;

        const columnToDataMap = {
            'SVC': predefinedData.SVC,
            'REG': predefinedData.REG,
            'TYPE': predefinedData.TYPE,
            'FROM': predefinedData.FROM,
            'DEST': predefinedData.DEST,
            'ADDRESSEE’S': predefinedData['ADDRESSEE’S']
        };

        function getColumnHeader(cell) {
            const table = cell.closest('table');
            const headerRow = table.querySelector('thead tr');
            const cellIndex = Array.from(cell.parentNode.children).indexOf(cell);
            return headerRow.children[cellIndex].innerText.trim();
        }

        function createFadedAutocomplete(cell) {
            let suggestion = document.createElement('span');
            suggestion.className = 'faded-suggestion';
            cell.appendChild(suggestion);
            cell.addEventListener('input', function () {
                const input = cell.innerText.toUpperCase();
                suggestion.innerText = '';
                if (input.length > 0) {
                    const columnHeader = getColumnHeader(cell);
                    const data = columnToDataMap[columnHeader] || [];
                    const startsWithMatch = data.find(item => item.startsWith(input));
                    const containsMatch = data.find(item => item.includes(input));
                    const match = startsWithMatch || containsMatch;
                    if (match) {
                        suggestion.innerText = match.slice(input.length);
                    }
                }
            });
            cell.addEventListener('keydown', function (event) {
                if (event.key === 'Tab' || event.key === 'Enter') {
                    event.preventDefault();
                    if (cell.innerText.trim() !== '') {
                        const input = cell.innerText.toUpperCase();
                        const columnHeader = getColumnHeader(cell);
                        const data = columnToDataMap[columnHeader] || [];
                        const startsWithMatch = data.find(item => item.startsWith(input));
                        const containsMatch = data.find(item => item.includes(input));
                        const match = startsWithMatch || containsMatch;
                        if (match) {
                            cell.innerText = match;
                            suggestion.innerText = '';
                        }
                    }
                    if (event.key === 'Tab') {
                        if (event.shiftKey) {
                            const prevCell = cell.previousElementSibling;
                            if (prevCell) prevCell.focus();
                        } else {
                            const nextCell = cell.nextElementSibling;
                            if (nextCell) nextCell.focus();
                        }
                    } else if (event.key === 'Enter') {
                        const nextRow = cell.parentElement.nextElementSibling;
                        if (nextRow) {
                            const nextCell = nextRow.cells[cell.cellIndex];
                            if (nextCell) nextCell.focus();
                        }
                    }
                }
                if (['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'].includes(event.key)) {
                    event.preventDefault();
                    let targetCell = null;
                    switch (event.key) {
                        case 'ArrowUp':
                            const prevRow = cell.parentElement.previousElementSibling;
                            if (prevRow) targetCell = prevRow.cells[cell.cellIndex];
                            break;
                        case 'ArrowDown':
                            const nextRow = cell.parentElement.nextElementSibling;
                            if (nextRow) targetCell = nextRow.cells[cell.cellIndex];
                            break;
                        case 'ArrowLeft':
                            targetCell = cell.previousElementSibling;
                            break;
                        case 'ArrowRight':
                            targetCell = cell.nextElementSibling;
                            break;
                    }
                    if (targetCell) targetCell.focus();
                }
            });
            cell.addEventListener('blur', function () {
                suggestion.innerText = '';
            });
        }

        document.querySelectorAll('td[contenteditable="true"]').forEach(cell => {
            createFadedAutocomplete(cell);
        });

        addRows();
        setCurrentDate();
        synchronizeInputs();

        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("/sw.js")
                .then(registration => console.log("Service Worker registered with scope:", registration.scope))
                .catch(error => console.error("Service Worker registration failed:", error));
        }
    </script>
</body>
</html>
